{% extends 'base.html' %}

{% block title %}Gmail Connected - Job Tracker{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">Gmail Connected</h1>
</div>

<div class="card" style="max-width: 500px; margin: 0 auto; text-align: center;">
    <div style="font-size: 3rem; margin-bottom: 1rem;">&#10003;</div>
    <h2 style="color: #27ae60; margin-bottom: 1rem;">Successfully Connected!</h2>
    <p style="margin-bottom: 0.5rem;">Connected as:</p>
    <p style="font-weight: 600; margin-bottom: 1.5rem;">{{ email }}</p>
    <p style="color: #7f8c8d; margin-bottom: 1.5rem;">Fetching your latest emails...</p>
    <a href="{{ emails_url }}" class="btn btn-primary">View Emails</a>
</div>

<script>
    async function fetchAndRedirect() {
        try {
            await fetch("{% url 'gmail:fetch-emails' %}");
        } catch (error) {
            console.error(error);
        } finally {
            window.location.href = "{{ emails_url }}";
        }
    }

    fetchAndRedirect();
</script>
{% endblock %}
